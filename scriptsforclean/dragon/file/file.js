FILE={server:function(e,n,a,i){var t=new HTTP;BASEAPI.ajax.get(t.path(["generalfiles","api"]),{folder:e},function(i){if(i.data.files){for(var r in i.data.files){var s=i.data.files[r];i.data.files[r]={url:`${t.path([FOLDERS.files,e])}/${s}`,cleanUrl:t.cleanRoot(`${t.path([FOLDERS.files,e])}${s}`),selected:!1,fileName:s,original:s.split("___")[0],ext:FILE.extension(s),isFolder:""===FILE.extension(s)},i.data.files[r].originalCrop=i.data.files[r].original}return i.data.files.length<=0&&a?a(i.data.files):n(i.data.files)}return n([])},i)},serverp:(e,n,a)=>new Promise((i,t)=>{FILE.server(e,function(e){i(e)},n,a)}),extension:function(e){var n=e.split(".");return n.length>1?ARRAY.last(n):""},isImage:function(e){var n=FILE.extension(e);return!!ARRAY.contains(["png","jpg","jpeg","gif"],n)},noSupport:function(e){var n=FILE.extension(e);return!!ARRAY.contains(["doc","docx","xls","xlsx"],n)},iconByExtension:function(e){switch(e){case"pdf":return ICON.i("file-pdf");case"xlsx":return ICON.i("file-excel");case"ppt":return ICON.i("file-presentation");case"csv":case"xls":return ICON.i("file-excel");case"gif":case"jpeg":case"jpg":case"png":return ICON.i("image2");case"html":return ICON.i("html5");case"doc":case"docx":return ICON.i("file-word");case"vb":case"cshtml":case"json":case"cs":case"php":case"js":return ICON.i("code");default:return ICON.i("file-"+e)}},fileToIcon:function(e){var n=FILE.extension(e);return FILE.iconByExtension(n)},fileToIconClass:function(e){var n=FILE.extension(e);return FILE.iconByExtension(n).split("'")[1]},addSourceToElement:function(e,n){switch(e.prop("tagName")){case"IMG":e.attr("src",n);break;case"A":e.attr("href",n)}},runServerFile:function(e){var n=e.parent(),a=e.data("dragonfile"),i=e.data("index"),t=n.find(`[data-dragonfile='${a}']:hidden:eq(0)`);t.length>0&&(n.find(`[data-dragonfile='${a}']:not(:hidden)`).remove(),e=t),FILE.server(a,function(n){if(void 0!==i){var a=e.clone();FILE.addSourceToElement(a,n[i].url),a.show(),e.after(a),e.hide()}else n.forEach(n=>{var a=e.clone();FILE.addSourceToElement(a,n.url),a.show(),e.after(a)}),e.hide()},function(){var n=e.clone();FILE.addSourceToElement(n,"assets/images/placeholder.jpg"),n.show(),e.after(n),e.hide()},e)}};
